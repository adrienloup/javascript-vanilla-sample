<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Sticky Elements</title>
		<style>

* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

body {
	font: 16px/1.6 -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol;
}

div {
	padding: 20px;
}

#element1 {
	background-color: #e6f2ff;
}

#element2 {
	background-color: #ffffe6;
}

#element3 {
	background-color: #ffe6ff;
}

#element4 {
	background-color: #e6ffe6;
}

		</style>
	</head>

	<body>

		<div>
			<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, ultricies eget venenatis sed, 		pulvinar sit amet arcu. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et volutpat lacus. Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, ultricies eget venenatis sed, pulvinar sit amet arcu. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et volutpat lacus. Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis.</p>
		</div>
		<div id="element1">Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</div>
		<div>
			<p>Aliquam dolor magna, tincidunt at luctus in, maximus eget enim. Mauris tellus ligula, porta sed magna quis, dictum placerat eros. Nulla placerat nec dui eget egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Praesent lacinia porta ultrices. Aenean quis tincidunt diam. Sed iaculis orci non aliquam euismod. Phasellus vel orci vitae mi elementum porta quis ut ligula. Integer commodo dictum velit ut interdum. Nulla eleifend mi non leo porttitor feugiat. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, aecenas et ultrices turpis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, ultricies eget venenatis sed, pulvinar sit amet arcu. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et volutpat lacus. Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis.</p>
		</div>
		<div id="element2">Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Phasellus vel orci vitae mi elementum porta quis ut ligula. Phasellus vel orci vitae mi elementum porta quis ut ligula. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit.</div>
		<div>
			<p>Proin tristique vestibulum urna vitae posuere. Nunc quis finibus augue. Aenean auctor, magna vitae interdum interdum, nisi nulla finibus nulla, eu ornare ipsum turpis vitae augue. Maecenas eu tristique velit, sed pretium nibh. Morbi mattis maximus sollicitudin. Vestibulum odio sem, ornare quis risus ut, iaculis auctor metus. Mauris ante ipsum, interdum sed ex non, luctus porta est. Integer pharetra ut orci pretium convallis. Nulla scelerisque pharetra feugiat. Quisque mi felis, sodales in molestie hendrerit, mollis tempor justo. Donec at suscipit nibh. In tellus augue, pretium molestie neque at, molestie placerat nisi. Proin rutrum mattis velit a finibus. Maecenas gravida mi non ultrices vestibulum. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis.</p>
		</div>
		<div id="element3">Vestibulum odio sem, ornare quis risus ut, iaculis auctor metus. Mauris ante ipsum, interdum sed ex non, luctus porta est. Integer pharetra ut orci pretium convallis. Nulla scelerisque pharetra feugiat. Quisque mi felis, sodales in molestie hendrerit, mollis tempor justo. Donec at suscipit nibh. In tellus augue, pretium molestie neque at, molestie placerat nisi. Proin rutrum mattis velit a finibus. Maecenas gravida mi non ultrices vestibulum. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, ultricies eget venenatis sed, pulvinar sit amet arcu. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et volutpat lacus.</div>
		<div>
			<p>Nunc et leo vitae turpis egestas vestibulum. Praesent lacinia sollicitudin lorem sed molestie. Sed placerat sagittis cursus. Nunc ornare convallis ligula, eget pretium sapien. Nunc imperdiet elementum nulla eget convallis. Cras viverra vel libero eget auctor. Nulla eleifend turpis et est lacinia, et hendrerit libero congue. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, ultricies eget venenatis sed, pulvinar sit amet arcu. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et volutpat lacus. Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis.</p>
		</div>
		<div id="element4">Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula.</div>
		<div>
			<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis. Aliquam dolor magna, tincidunt at luctus in, maximus eget enim. Mauris tellus ligula, porta sed magna quis, dictum placerat eros. Nulla placerat nec dui eget egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Praesent lacinia porta ultrices. Aenean quis tincidunt diam. Sed iaculis orci non aliquam euismod. Phasellus vel orci vitae mi elementum porta quis ut ligula. Integer commodo dictum velit ut interdum. Nulla eleifend mi non leo porttitor feugiat. In eu dui dictum, interdum quam vel, rhoncus leo. Vestibulum dignissim ante ut ligula consequat vulputate. Sed feugiat ut dolor nec efficitur. In ac massa quis augue malesuada mollis. Nam congue molestie mauris sodales posuere. Etiam non enim lorem. Morbi volutpat risus lobortis, viverra nisl in, aliquet purus. Mauris imperdiet sem non diam dapibus, a finibus nisl interdum. Maecenas cursus orci eget commodo iaculis. Aliquam dolor magna, tincidunt at luctus in, maximus eget enim. Mauris tellus ligula, porta sed magna quis, dictum placerat eros. Nulla placerat nec dui eget egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aliquam dolor magna, tincidunt at luctus in, maximus eget enim. Mauris tellus ligula, porta sed magna quis, dictum placerat eros. Nulla placerat nec dui eget egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Proin tristique vestibulum urna vitae posuere. Nunc quis finibus augue. Aenean auctor, magna vitae interdum interdum, nisi nulla finibus nulla, eu ornare ipsum turpis vitae augue. Maecenas eu tristique velit, sed pretium nibh. Morbi mattis maximus sollicitudin. Vestibulum odio sem, ornare quis risus ut, iaculis auctor metus. Mauris ante ipsum, interdum sed ex non, luctus porta est. Integer pharetra ut orci pretium convallis. Nulla scelerisque pharetra feugiat. Quisque mi felis, sodales in molestie hendrerit, mollis tempor justo. Donec at suscipit nibh. In tellus augue, pretium molestie neque at, molestie placerat nisi. Aliquam dolor magna, tincidunt at luctus in, maximus eget enim. Mauris tellus ligula, porta sed magna quis, dictum placerat eros. Nulla placerat nec dui eget egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Proin rutrum mattis velit a finibus. Maecenas gravida mi non ultrices vestibulum. Nunc et leo vitae turpis egestas vestibulum. Praesent lacinia sollicitudin lorem sed molestie. Sed placerat sagittis cursus. Nunc ornare convallis ligula, eget pretium sapien. Nunc imperdiet elementum nulla eget convallis. Cras viverra vel libero eget auctor. Nulla eleifend turpis et est lacinia, et hendrerit libero congue.Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer augue augue, ultricies eget venenatis sed, pulvinar sit amet arcu. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec et volutpat lacus. Sed euismod dui eget nibh rutrum, non bibendum massa dignissim. Integer accumsan varius erat ut dignissim. Aenean vulputate nisi et ante dignissim, in eleifend diam mattis. Curabitur vitae tristique urna, eget auctor quam. Phasellus neque augue, elementum ac blandit eu, tempus vel neque. In nec leo velit. Mauris aliquam porta vehicula. Maecenas et ultrices turpis. Aliquam dolor magna, tincidunt at luctus in, maximus eget enim. Mauris tellus ligula, porta sed magna quis, dictum placerat eros. Nulla placerat nec dui eget egestas. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Praesent lacinia porta ultrices. Aenean quis tincidunt diam. Sed iaculis orci non aliquam euismod. Phasellus vel orci vitae mi elementum porta quis ut ligula. Integer commodo dictum velit ut interdum. Nulla eleifend mi non leo porttitor feugiat. In eu dui dictum, interdum quam vel, rhoncus leo. Vestibulum dignissim ante ut ligula consequat vulputate. Sed feugiat ut dolor nec efficitur. In ac massa quis augue malesuada mollis. Nam congue molestie mauris sodales posuere. Etiam non enim lorem. Morbi volutpat risus lobortis, viverra nisl in, aliquet purus. Mauris imperdiet sem non diam dapibus, a finibus nisl interdum. Maecenas cursus orci eget commodo iaculis. Proin tristique vestibulum urna vitae posuere. Nunc quis finibus augue. Aenean auctor, magna vitae interdum interdum, nisi nulla finibus nulla, eu ornare ipsum turpis vitae augue. Maecenas eu tristique velit, sed pretium nibh. Morbi mattis maximus sollicitudin. Vestibulum odio sem, ornare quis risus ut, iaculis auctor metus. Mauris ante ipsum, interdum sed ex non, luctus porta est. Integer pharetra ut orci pretium convallis. Nulla scelerisque pharetra feugiat. Quisque mi felis, sodales in molestie hendrerit, mollis tempor justo. Donec at suscipit nibh. In tellus augue, pretium molestie neque at, molestie placerat nisi. Proin rutrum mattis velit a finibus. Maecenas gravida mi non ultrices vestibulum. Nunc et leo vitae turpis egestas vestibulum. Praesent lacinia sollicitudin lorem sed molestie. Sed placerat sagittis cursus. Nunc ornare convallis ligula, eget pretium sapien. Nunc imperdiet elementum nulla eget convallis. Cras viverra vel libero eget auctor.</p>
		</div>

		<script>

class Sticky {

	constructor(element) {
		this.element = document.querySelector(element)
		this.sticky = false
		this.clone = null
		this.height = null
		this.offset = null
		this.scroll = 0
		this.top = 0
		this.all = null
	}

	events() {
		window.addEventListener('resize', _ => this.onResize())
		window.addEventListener('scroll', _ => this.onScroll())
	}

	init() {
		this.element.classList.add('sticky')
		this.all = document.querySelectorAll('.sticky')
		this.events()
		this.onResize()
	}

	creatClone() {
		let div = document.createElement('div')
		div.style.height = this.height + 'px'
		this.element.parentNode.insertBefore(div, this.element)
		this.clone = this.element.previousSibling
	}

	elementTaped() {
		this.element.style.position = 'fixed'
		this.element.style.top = this.top + 'px'
	}

	elementTakeOff() {
		this.element.style = ''
		this.element.previousSibling.remove()
	}

	taped() {
		if(!this.sticky) {
			this.creatClone()
			this.elementTaped()
			this.sticky = true
			return
		}
	}

	takeOff() {
		if(this.sticky) {
			this.elementTakeOff()
			this.clone = null
			this.sticky = false
			return
		}
	}

	render() {
		(this.scroll >= (this.offset - this.top))
		? this.taped()
		: this.takeOff()
	}

	onScroll() {
		this.scroll = window.pageYOffset
		this.render()
	}

	onResize() {

		this.height = this.element.clientHeight
		this.element.style.top = this.top + 'px'

		if(this.clone) {
			this.clone.style.height = this.height + 'px'
			this.offset = this.clone.offsetTop
		} else {
			this.offset = this.element.offsetTop
		}

		let allHeight = 0
		for(let i = 0, l = this.all.length; i < l; i++) {
			if(this.all[i-1] !== undefined) {
				allHeight += this.all[i-1].clientHeight
			}
		}
		this.top = allHeight

	}

}

const element1 = new Sticky('#element1')
const element2 = new Sticky('#element2')
const element3 = new Sticky('#element3')
const element4 = new Sticky('#element4')

element1.init()
element2.init()
element3.init()
element4.init()

		</script>

	</body>

</html>
